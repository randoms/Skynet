底层架构设计
每个节点不仅要向外发请求还要响应别人的请求。响应的时间可能会比较长。所以要做成异步的模式。
所有的请求和响应都是通过tox网络发出去的，这个和http请求还不太一样。所以要加一些东西来区分出每个请求对应的每个响应。
还要考虑消息有长度限制，底层要自动的实现分包

request
{
	url: the target resource
	method: get, post, update, delete, etc
	uuid: the uuid of the request
	from: from toxid,
	to: to toxid,
	content: msg content
}

分包

{
	id: uuid
	type: start, content, end
	content: package content
}

遇到 type == start, 在包Cache里面新加一个


2015年8月22日09:17:11
非常好第一次通信成功


Requset

from 

node uuid
toxid
request uuid

一个tox client 可以有多个node， 每个node都有唯一的一个id。client是属于底层的结构不对上层的app层开放。
app层至多能看到node层

request url的结构定义

底层 tox client 层， 比如handshake，貌似没必要吧
url: tox/[actions]

node层， 比如添加父级节点
url: node/[data entities]
	风格上和 restful api 一致， 比如添加父级节点实际上就是 post 到 node/childNodes。也就是在对方的子节点
	加上自己的记录


节点的变化
1.节点的互换
	节点优化的主要过程
	特点： 发生时机是可控的
2.节点的新增
	新节点加入网络
	特点： 发生时机随机不可控
3.节点的删除
	节点退出网络
	特点发生时机随机不可控

当有节点下线时应进行的操作
1. 把此节点从自己的数据中删除，同时删除toxcore friend记录
2. 所有可能的情况如下
	1.父节点下线
	从兄弟节点中按照顺序选择一个作为父节点。但是此时目标兄弟节点可能子节点个数已经满了。那就走一般的加入节点流程。这样出
	来的结果可能是很随机的。但是这并没有什么影响。节点结构可以在以后进行优化。
	通知其子节点自己的父节点发生了变化
	2.子节点下线
	通知其他子节点，自己的子节点发生了变化。删除相应的记录及toxcore friend记录
	3.父父节点下线
	删除记录
	4.兄弟节点下线
	删除记录
